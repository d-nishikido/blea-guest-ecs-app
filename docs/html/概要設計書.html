<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BLEA Guest ECS アプリケーション概要設計書</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "Helvetica Neue", "Hiragino Sans", "Yu Gothic", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        h1 {
            color: #232F3E;
            border-bottom: 3px solid #FF9900;
            padding-bottom: 10px;
            margin-top: 30px;
        }
        
        h2 {
            color: #232F3E;
            border-bottom: 2px solid #FF9900;
            padding-bottom: 8px;
            margin-top: 25px;
        }
        
        h3 {
            color: #232F3E;
            margin-top: 20px;
        }
        
        h4 {
            color: #555;
            margin-top: 15px;
        }
        
        table {
            border-collapse: collapse;
            width: 100%;
            margin: 15px 0;
            background-color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        th {
            background-color: #232F3E;
            color: white;
            padding: 12px;
            text-align: left;
            font-weight: bold;
        }
        
        td {
            border: 1px solid #ddd;
            padding: 10px;
        }
        
        tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        code {
            background-color: #f4f4f4;
            padding: 2px 5px;
            border-radius: 3px;
            font-family: "Courier New", monospace;
            font-size: 0.9em;
        }
        
        pre {
            background-color: #282c34;
            color: #abb2bf;
            padding: 15px;
            border-radius: 5px;
            overflow-x: auto;
            margin: 15px 0;
        }
        
        pre code {
            background-color: transparent;
            color: inherit;
            padding: 0;
        }
        
        ul, ol {
            margin: 10px 0;
            padding-left: 30px;
        }
        
        li {
            margin: 5px 0;
        }
        
        .architecture-diagram {
            background-color: white;
            border: 2px solid #ddd;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
            font-family: monospace;
            line-height: 1.8;
        }
        
        .toc {
            background-color: white;
            border: 2px solid #FF9900;
            border-radius: 5px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .toc h2 {
            margin-top: 0;
            border-bottom: 2px solid #FF9900;
            padding-bottom: 10px;
        }
        
        .toc ul {
            list-style-type: none;
            padding-left: 20px;
        }
        
        .toc a {
            color: #232F3E;
            text-decoration: none;
        }
        
        .toc a:hover {
            color: #FF9900;
            text-decoration: underline;
        }
        
        .note {
            background-color: #fff3cd;
            border-left: 4px solid #FF9900;
            padding: 10px 15px;
            margin: 15px 0;
        }
        
        .important {
            background-color: #f8d7da;
            border-left: 4px solid #dc3545;
            padding: 10px 15px;
            margin: 15px 0;
        }
        
        .success {
            background-color: #d4edda;
            border-left: 4px solid #28a745;
            padding: 10px 15px;
            margin: 15px 0;
        }
        
        input[type="checkbox"] {
            margin-right: 5px;
        }
        
        hr {
            border: none;
            border-top: 2px solid #ddd;
            margin: 30px 0;
        }
    </style>
</head>
<body>
    <h1>BLEA Guest ECS アプリケーション概要設計書</h1>
    
    <div class="toc">
        <h2>目次</h2>
        <ul>
            <li><a href="#section1">1. システム概要</a></li>
            <li><a href="#section2">2. アーキテクチャ設計</a></li>
            <li><a href="#section3">3. ネットワーク設計</a></li>
            <li><a href="#section4">4. コンピューティング設計</a></li>
            <li><a href="#section5">5. データベース設計</a></li>
            <li><a href="#section6">6. CDN/フロントエンド設計</a></li>
            <li><a href="#section7">7. セキュリティ設計</a></li>
            <li><a href="#section8">8. 監視・運用設計</a></li>
            <li><a href="#section9">9. CI/CDパイプライン設計</a></li>
            <li><a href="#section10">10. 災害復旧計画</a></li>
            <li><a href="#section11">11. コスト最適化</a></li>
            <li><a href="#section12">12. 今後の拡張計画</a></li>
            <li><a href="#appendixA">付録A: パラメータ一覧</a></li>
            <li><a href="#appendixB">付録B: ディレクトリ構造</a></li>
            <li><a href="#appendixC">付録C: 利用AWSサービス一覧</a></li>
        </ul>
    </div>

    <h2 id="section1">1. システム概要</h2>
    
    <h3>1.1 プロジェクト概要</h3>
    <p>本プロジェクトは、AWS上でコンテナ化されたWebアプリケーションを実行するための基盤環境（BLEA: Baseline Environment on AWS）のサンプル実装です。ECS/Fargateを使用したコンテナオーケストレーション、Aurora PostgreSQLデータベース、CloudFrontによるコンテンツ配信、包括的な監視機能を提供します。</p>
    
    <h3>1.2 システムの目的</h3>
    <ul>
        <li>セキュアでスケーラブルなコンテナベースのWebアプリケーション基盤の提供</li>
        <li>AWSベストプラクティスに準拠した本番環境対応のアーキテクチャ</li>
        <li>包括的な監視とアラート機能による高可用性の実現</li>
        <li>Infrastructure as Code（IaC）によるインフラ管理の自動化</li>
    </ul>
    
    <h3>1.3 主要技術スタック</h3>
    <ul>
        <li><strong>インフラ管理</strong>: AWS CDK v2（TypeScript）</li>
        <li><strong>コンテナオーケストレーション</strong>: Amazon ECS on Fargate</li>
        <li><strong>データベース</strong>: Amazon Aurora PostgreSQL</li>
        <li><strong>CDN</strong>: Amazon CloudFront</li>
        <li><strong>監視</strong>: Amazon CloudWatch, AWS Synthetics</li>
    </ul>
    
    <h2 id="section2">2. アーキテクチャ設計</h2>
    
    <h3>2.1 全体アーキテクチャ</h3>
    <div class="architecture-diagram">
        インターネット<br>
        ↓<br>
        CloudFront（CDN）<br>
        ↓<br>
        AWS WAF（Webアプリケーションファイアウォール）<br>
        ↓<br>
        Application Load Balancer（ALB）<br>
        ↓<br>
        ECS Fargate（コンテナ）<br>
        ↓<br>
        Aurora PostgreSQL（データベース）
    </div>
    
    <h3>2.2 スタック構成</h3>
    
    <h4>2.2.1 バックエンドスタック（BLEAEcsAppStack）</h4>
    <ul>
        <li><strong>責務</strong>: コアインフラストラクチャとバックエンドサービスの管理</li>
        <li><strong>主要コンポーネント</strong>:
            <ul>
                <li>VPCネットワーク</li>
                <li>ECSクラスタとサービス</li>
                <li>Aurora PostgreSQLデータベース</li>
                <li>Application Load Balancer</li>
                <li>KMS暗号化キー</li>
            </ul>
        </li>
    </ul>
    
    <h4>2.2.2 フロントエンドスタック（BLEAEcsAppFrontendStack）</h4>
    <ul>
        <li><strong>責務</strong>: CDNとWebセキュリティの管理</li>
        <li><strong>主要コンポーネント</strong>:
            <ul>
                <li>CloudFrontディストリビューション</li>
                <li>AWS WAF v2</li>
                <li>静的コンテンツ用S3バケット</li>
                <li>カスタムドメイン対応（オプション）</li>
            </ul>
        </li>
    </ul>
    
    <h4>2.2.3 監視スタック（BLEAEcsAppMonitoringStack）</h4>
    <ul>
        <li><strong>責務</strong>: システム全体の監視と可観測性</li>
        <li><strong>主要コンポーネント</strong>:
            <ul>
                <li>CloudWatchダッシュボード</li>
                <li>Syntheticsカナリー</li>
                <li>アラーム設定</li>
                <li>通知設定（Email/Slack）</li>
            </ul>
        </li>
    </ul>
    
    <h4>2.2.4 パイプラインスタック（BLEAEcsAppPipelineStack）</h4>
    <ul>
        <li><strong>責務</strong>: CI/CDパイプラインの管理</li>
        <li><strong>主要コンポーネント</strong>:
            <ul>
                <li>CodePipeline</li>
                <li>CodeBuild</li>
                <li>GitHub連携（CodeStar Connections）</li>
            </ul>
        </li>
    </ul>
    
    <h3>2.3 主要コンストラクト</h3>
    <table>
        <thead>
            <tr>
                <th>コンストラクト</th>
                <th>説明</th>
                <th>実装ファイル</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Networking</td>
                <td>VPCとサブネット構成</td>
                <td><code>lib/construct/networking.ts</code></td>
            </tr>
            <tr>
                <td>Datastore</td>
                <td>Aurora PostgreSQLクラスタ</td>
                <td><code>lib/construct/datastore.ts</code></td>
            </tr>
            <tr>
                <td>EcsApp</td>
                <td>ECSサービスと自動スケーリング</td>
                <td><code>lib/construct/ecsapp.ts</code></td>
            </tr>
            <tr>
                <td>Frontend</td>
                <td>CloudFrontとWAF設定</td>
                <td><code>lib/construct/frontend.ts</code></td>
            </tr>
            <tr>
                <td>Monitoring</td>
                <td>SNSトピックとアラート基盤</td>
                <td><code>lib/construct/monitoring.ts</code></td>
            </tr>
            <tr>
                <td>Dashboard</td>
                <td>CloudWatchダッシュボード</td>
                <td><code>lib/construct/dashboard.ts</code></td>
            </tr>
            <tr>
                <td>Canary</td>
                <td>Synthetics監視</td>
                <td><code>lib/construct/canary.ts</code></td>
            </tr>
        </tbody>
    </table>
    
    <h2 id="section3">3. ネットワーク設計</h2>
    
    <h3>3.1 VPC構成</h3>
    <ul>
        <li><strong>CIDR範囲</strong>: 設定可能（デフォルト: 10.100.0.0/16）</li>
        <li><strong>可用性ゾーン</strong>: 2つのAZに跨る構成</li>
        <li><strong>NATゲートウェイ</strong>: コスト最適化のため単一NAT</li>
    </ul>
    
    <h3>3.2 サブネット設計</h3>
    <table>
        <thead>
            <tr>
                <th>サブネット種別</th>
                <th>CIDR</th>
                <th>用途</th>
                <th>インターネット接続</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>パブリック</td>
                <td>/24</td>
                <td>ALB配置</td>
                <td>直接接続</td>
            </tr>
            <tr>
                <td>プライベート</td>
                <td>/22</td>
                <td>ECSタスク</td>
                <td>NAT経由</td>
            </tr>
            <tr>
                <td>プロテクテッド</td>
                <td>/22</td>
                <td>Aurora DB</td>
                <td>接続なし</td>
            </tr>
        </tbody>
    </table>
    
    <h3>3.3 VPCエンドポイント</h3>
    <ul>
        <li><strong>ゲートウェイエンドポイント</strong>: S3</li>
        <li><strong>インターフェースエンドポイント</strong>:
            <ul>
                <li>ECR（API、DKR）</li>
                <li>CloudWatch Logs</li>
                <li>Systems Manager</li>
                <li>EC2</li>
            </ul>
        </li>
    </ul>
    
    <h3>3.4 セキュリティグループ</h3>
    <table>
        <thead>
            <tr>
                <th>セキュリティグループ</th>
                <th>インバウンド</th>
                <th>アウトバウンド</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>ALB</td>
                <td>HTTP(80), HTTPS(443) from Internet</td>
                <td>ECSタスク向け</td>
            </tr>
            <tr>
                <td>ECSタスク</td>
                <td>ALBからのトラフィック</td>
                <td>すべて許可</td>
            </tr>
            <tr>
                <td>Aurora</td>
                <td>ECSタスクからPostgreSQL(5432)</td>
                <td>なし</td>
            </tr>
        </tbody>
    </table>
    
    <h2 id="section4">4. コンピューティング設計</h2>
    
    <h3>4.1 ECS構成</h3>
    <ul>
        <li><strong>起動タイプ</strong>: Fargate</li>
        <li><strong>プラットフォームバージョン</strong>: LATEST</li>
        <li><strong>タスク定義</strong>:
            <ul>
                <li>CPU: 1024（1 vCPU）</li>
                <li>メモリ: 2048 MB</li>
                <li>ネットワークモード: awsvpc</li>
            </ul>
        </li>
    </ul>
    
    <h3>4.2 自動スケーリング設定</h3>
    <table>
        <thead>
            <tr>
                <th>設定項目</th>
                <th>値</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>最小タスク数</td>
                <td>2</td>
            </tr>
            <tr>
                <td>最大タスク数</td>
                <td>10</td>
            </tr>
            <tr>
                <td>CPU使用率ターゲット</td>
                <td>50%</td>
            </tr>
            <tr>
                <td>リクエスト数ターゲット</td>
                <td>10,000リクエスト/ターゲット</td>
            </tr>
        </tbody>
    </table>
    
    <h3>4.3 コンテナ設定</h3>
    <ul>
        <li><strong>イメージ</strong>: Amazon ECR パブリックギャラリー</li>
        <li><strong>ログ</strong>: CloudWatch Logsに出力</li>
        <li><strong>ヘルスチェック</strong>: ALB経由でHTTPヘルスチェック</li>
    </ul>
    
    <h2 id="section5">5. データベース設計</h2>
    
    <h3>5.1 Aurora PostgreSQL構成</h3>
    <ul>
        <li><strong>エンジンバージョン</strong>: Aurora PostgreSQL 11.9</li>
        <li><strong>クラスタ構成</strong>:
            <ul>
                <li>ライターインスタンス: 1台</li>
                <li>リーダーインスタンス: 1台</li>
            </ul>
        </li>
        <li><strong>インスタンスタイプ</strong>: t3.medium</li>
        <li><strong>ストレージ暗号化</strong>: KMS CMKによる暗号化</li>
    </ul>
    
    <h3>5.2 バックアップとリカバリ</h3>
    <ul>
        <li><strong>自動バックアップ</strong>: 有効</li>
        <li><strong>バックアップ保持期間</strong>: 設定可能</li>
        <li><strong>スナップショット</strong>: 暗号化されたスナップショット</li>
        <li><strong>Performance Insights</strong>: 有効（KMS暗号化）</li>
    </ul>
    
    <h3>5.3 監視設定</h3>
    <ul>
        <li><strong>メトリクス</strong>: CPU使用率、接続数、レイテンシー</li>
        <li><strong>ログ</strong>: PostgreSQLログをCloudWatchに出力</li>
        <li><strong>アラーム</strong>: CPU使用率、接続数の閾値監視</li>
    </ul>
    
    <h2 id="section6">6. CDN/フロントエンド設計</h2>
    
    <h3>6.1 CloudFront設定</h3>
    <ul>
        <li><strong>オリジン</strong>: Application Load Balancer</li>
        <li><strong>ビヘイビア</strong>:
            <ul>
                <li>デフォルト: 動的コンテンツ（キャッシュ無効）</li>
                <li><code>/static/*</code>: 静的コンテンツ（キャッシュ有効）</li>
            </ul>
        </li>
        <li><strong>プロトコル</strong>: HTTPS強制（HTTPからリダイレクト）</li>
        <li><strong>ログ</strong>: S3バケットへのアクセスログ</li>
    </ul>
    
    <h3>6.2 WAF設定</h3>
    <table>
        <thead>
            <tr>
                <th>ルールセット</th>
                <th>説明</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>共通ルール</td>
                <td>OWASP Top 10対策</td>
            </tr>
            <tr>
                <td>既知の不正入力</td>
                <td>既知の攻撃パターン</td>
            </tr>
            <tr>
                <td>IP評価リスト</td>
                <td>悪意のあるIPアドレス</td>
            </tr>
            <tr>
                <td>Linuxルール</td>
                <td>Linux固有の脆弱性対策</td>
            </tr>
            <tr>
                <td>SQLインジェクション</td>
                <td>SQLi攻撃対策</td>
            </tr>
        </tbody>
    </table>
    
    <h3>6.3 静的コンテンツ配信</h3>
    <ul>
        <li><strong>S3バケット</strong>: バージョニング有効</li>
        <li><strong>アクセス制御</strong>: CloudFront経由のみ許可</li>
        <li><strong>エラーページ</strong>: カスタム403エラーページ</li>
    </ul>
    
    <h2 id="section7">7. セキュリティ設計</h2>
    
    <h3>7.1 暗号化</h3>
    <ul>
        <li><strong>保存データ</strong>:
            <ul>
                <li>KMS CMKによる暗号化（Aurora、CloudWatch Logs、S3）</li>
                <li>自動キーローテーション有効</li>
            </ul>
        </li>
        <li><strong>転送中データ</strong>:
            <ul>
                <li>全サービスでSSL/TLS強制</li>
                <li>ALB-ECS間もHTTPS通信</li>
            </ul>
        </li>
    </ul>
    
    <h3>7.2 アクセス制御</h3>
    <ul>
        <li><strong>IAMロール</strong>: 最小権限の原則に基づく設計</li>
        <li><strong>サービスロール</strong>:
            <ul>
                <li>ECSタスク実行ロール</li>
                <li>ECSタスクロール</li>
                <li>Lambda実行ロール</li>
            </ul>
        </li>
        <li><strong>リソースポリシー</strong>: S3バケットポリシーによる制御</li>
    </ul>
    
    <h3>7.3 ネットワークセキュリティ</h3>
    <ul>
        <li><strong>多層防御</strong>: WAF → ALB → セキュリティグループ → NACL</li>
        <li><strong>ネットワーク分離</strong>: パブリック/プライベート/プロテクテッドサブネット</li>
        <li><strong>VPCフローログ</strong>: 全トラフィックの記録と分析</li>
    </ul>
    
    <h3>7.4 コンプライアンス</h3>
    <ul>
        <li><strong>ログ保管</strong>: 全サービスログの集約と保管</li>
        <li><strong>監査証跡</strong>: CloudTrailによる操作記録（将来実装）</li>
        <li><strong>暗号化標準</strong>: AWS KMSによる業界標準暗号化</li>
    </ul>
    
    <h2 id="section8">8. 監視・運用設計</h2>
    
    <h3>8.1 CloudWatchメトリクス</h3>
    <table>
        <thead>
            <tr>
                <th>カテゴリ</th>
                <th>監視項目</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>ECS</td>
                <td>CPU使用率、メモリ使用率、タスク数</td>
            </tr>
            <tr>
                <td>ALB</td>
                <td>レスポンスタイム、HTTPエラー率、接続エラー</td>
            </tr>
            <tr>
                <td>Aurora</td>
                <td>CPU使用率、接続数、レイテンシー</td>
            </tr>
            <tr>
                <td>CloudFront</td>
                <td>リクエスト数、エラー率、オリジンレイテンシー</td>
            </tr>
        </tbody>
    </table>
    
    <h3>8.2 アラーム設定</h3>
    <table>
        <thead>
            <tr>
                <th>アラーム</th>
                <th>閾値</th>
                <th>アクション</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>ECS CPU高使用率</td>
                <td>&gt; 80%</td>
                <td>SNS通知</td>
            </tr>
            <tr>
                <td>ALB 5xxエラー</td>
                <td>&gt; 10/分</td>
                <td>SNS通知</td>
            </tr>
            <tr>
                <td>Aurora CPU高使用率</td>
                <td>&gt; 80%</td>
                <td>SNS通知</td>
            </tr>
            <tr>
                <td>カナリー失敗</td>
                <td>2回連続失敗</td>
                <td>SNS通知</td>
            </tr>
        </tbody>
    </table>
    
    <h3>8.3 ダッシュボード構成</h3>
    <ul>
        <li><strong>概要ビュー</strong>: システム全体の健全性</li>
        <li><strong>パフォーマンスビュー</strong>: レスポンスタイムとスループット</li>
        <li><strong>エラービュー</strong>: 各層のエラー率</li>
        <li><strong>リソース使用状況</strong>: CPU、メモリ、ネットワーク</li>
    </ul>
    
    <h3>8.4 Syntheticsカナリー</h3>
    <ul>
        <li><strong>監視間隔</strong>: 5分ごと</li>
        <li><strong>監視内容</strong>: エンドポイントの可用性とレスポンスタイム</li>
        <li><strong>アラート</strong>: 2回連続失敗時に通知</li>
    </ul>
    
    <h3>8.5 通知設定</h3>
    <ul>
        <li><strong>Email通知</strong>: SNS経由でのメール送信</li>
        <li><strong>Slack通知</strong>: AWS Chatbot経由でのSlack連携</li>
        <li><strong>通知内容</strong>: アラーム名、状態、タイムスタンプ</li>
    </ul>
    
    <h2 id="section9">9. CI/CDパイプライン設計</h2>
    
    <h3>9.1 パイプライン構成</h3>
    <ol>
        <li><strong>ソース</strong>: GitHub（CodeStar Connections経由）</li>
        <li><strong>ビルド</strong>: CodeBuild（CDKシンセサイズ）</li>
        <li><strong>デプロイ</strong>: CDK Deploy（自己更新可能）</li>
    </ol>
    
    <h3>9.2 環境戦略</h3>
    <ul>
        <li><strong>開発環境</strong>: 自動デプロイ</li>
        <li><strong>本番環境</strong>: 手動承認後デプロイ（将来実装）</li>
        <li><strong>ブランチ戦略</strong>: mainブランチからのデプロイ</li>
    </ul>
    
    <h3>9.3 セキュリティ</h3>
    <ul>
        <li><strong>クロスアカウント</strong>: 信頼関係によるデプロイ</li>
        <li><strong>シークレット管理</strong>: Systems Manager Parameter Store</li>
        <li><strong>監査</strong>: パイプライン実行ログの保管</li>
    </ul>
    
    <h2 id="section10">10. 災害復旧計画</h2>
    
    <h3>10.1 バックアップ戦略</h3>
    <ul>
        <li><strong>データベース</strong>: 自動バックアップ + 手動スナップショット</li>
        <li><strong>設定情報</strong>: Infrastructure as Codeによる再現性</li>
        <li><strong>ログ</strong>: S3への長期保管</li>
    </ul>
    
    <h3>10.2 復旧目標</h3>
    <ul>
        <li><strong>RPO（目標復旧時点）</strong>: 1時間</li>
        <li><strong>RTO（目標復旧時間）</strong>: 4時間</li>
        <li><strong>可用性目標</strong>: 99.9%</li>
    </ul>
    
    <h3>10.3 フェイルオーバー</h3>
    <ul>
        <li><strong>ECS</strong>: 複数AZでの自動復旧</li>
        <li><strong>Aurora</strong>: 自動フェイルオーバー</li>
        <li><strong>CloudFront</strong>: グローバルな冗長性</li>
    </ul>
    
    <h2 id="section11">11. コスト最適化</h2>
    
    <h3>11.1 実装済み最適化</h3>
    <ul>
        <li><strong>単一NATゲートウェイ</strong>: 開発環境でのコスト削減</li>
        <li><strong>t3.mediumインスタンス</strong>: 開発環境用の小規模インスタンス</li>
        <li><strong>S3ライフサイクル</strong>: ログの自動アーカイブ（将来実装）</li>
    </ul>
    
    <h3>11.2 将来の最適化案</h3>
    <ul>
        <li><strong>Fargate Spot</strong>: スポットインスタンスの活用</li>
        <li><strong>予約インスタンス</strong>: 本番環境での割引</li>
        <li><strong>オートスケーリング</strong>: 需要に応じた自動調整</li>
    </ul>
    
    <h2 id="section12">12. 今後の拡張計画</h2>
    
    <h3>12.1 短期計画</h3>
    <ul>
        <li><input type="checkbox"> カスタムドメインの実装</li>
        <li><input type="checkbox"> 本番環境用パラメータの追加</li>
        <li><input type="checkbox"> CloudTrailの導入</li>
        <li><input type="checkbox"> Secrets Managerの統合</li>
    </ul>
    
    <h3>12.2 中期計画</h3>
    <ul>
        <li><input type="checkbox"> マルチリージョン対応</li>
        <li><input type="checkbox"> ブルーグリーンデプロイメント</li>
        <li><input type="checkbox"> API Gateway統合</li>
        <li><input type="checkbox"> コンテナイメージのセキュリティスキャン</li>
    </ul>
    
    <h3>12.3 長期計画</h3>
    <ul>
        <li><input type="checkbox"> サービスメッシュ（App Mesh）導入</li>
        <li><input type="checkbox"> 分散トレーシング強化</li>
        <li><input type="checkbox"> 機械学習による異常検知</li>
        <li><input type="checkbox"> コスト分析ダッシュボード</li>
    </ul>
    
    <h2 id="appendixA">付録A: パラメータ一覧</h2>
    
    <h3>必須パラメータ</h3>
    <table>
        <thead>
            <tr>
                <th>パラメータ</th>
                <th>説明</th>
                <th>デフォルト値</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>envName</td>
                <td>環境名</td>
                <td>Development</td>
            </tr>
            <tr>
                <td>vpcCidr</td>
                <td>VPC CIDR</td>
                <td>10.100.0.0/16</td>
            </tr>
            <tr>
                <td>monitoringNotifyEmail</td>
                <td>通知先メール</td>
                <td>-</td>
            </tr>
            <tr>
                <td>monitoringSlackWorkspaceId</td>
                <td>Slack ワークスペースID</td>
                <td>-</td>
            </tr>
            <tr>
                <td>monitoringSlackChannelId</td>
                <td>Slack チャンネルID</td>
                <td>-</td>
            </tr>
        </tbody>
    </table>
    
    <h3>オプションパラメータ</h3>
    <table>
        <thead>
            <tr>
                <th>パラメータ</th>
                <th>説明</th>
                <th>デフォルト値</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>hostedZoneId</td>
                <td>Route 53 ホストゾーンID</td>
                <td>-</td>
            </tr>
            <tr>
                <td>domainName</td>
                <td>カスタムドメイン名</td>
                <td>-</td>
            </tr>
            <tr>
                <td>cloudFrontHostName</td>
                <td>CloudFrontホスト名</td>
                <td>-</td>
            </tr>
        </tbody>
    </table>
    
    <h2 id="appendixB">付録B: ディレクトリ構造</h2>
    <pre><code>blea-guest-ecs-app/
├── bin/                          # CDKアプリケーションエントリポイント
│   ├── blea-guest-ecs-app-sample.ts
│   └── blea-guest-ecs-app-sample-via-cdk-pipelines.ts
├── lib/
│   ├── construct/               # 再利用可能なコンストラクト
│   │   ├── canary.ts
│   │   ├── dashboard.ts
│   │   ├── datastore.ts
│   │   ├── ecsapp.ts
│   │   ├── frontend.ts
│   │   ├── monitoring.ts
│   │   └── networking.ts
│   ├── stack/                   # CDKスタック定義
│   │   ├── blea-guest-ecs-app-frontend-stack.ts
│   │   ├── blea-guest-ecs-app-monitoring-stack.ts
│   │   ├── blea-guest-ecs-app-sample-stack.ts
│   │   └── blea-guest-ecs-app-sample-via-cdk-pipelines-stack.ts
│   └── stage/                   # CDKステージ定義
│       └── blea-guest-ecs-app-sample-stage.ts
├── test/                        # テストファイル
├── parameter.ts                 # 環境パラメータ
├── package.json                 # プロジェクト設定
├── tsconfig.json               # TypeScript設定
└── cdk.json                    # CDK設定</code></pre>
    
    <hr>
    
    <h2 id="appendixC">付録C: 利用AWSサービス一覧</h2>
    
    <h3>コンピュート・コンテナ</h3>
    <table>
        <thead>
            <tr>
                <th>サービス名</th>
                <th>用途</th>
                <th>主な利用機能</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Amazon ECS</td>
                <td>コンテナオーケストレーション</td>
                <td>Fargate起動タイプ、タスク定義、サービス</td>
            </tr>
            <tr>
                <td>AWS Fargate</td>
                <td>サーバーレスコンテナ実行</td>
                <td>タスク実行、自動スケーリング</td>
            </tr>
            <tr>
                <td>Amazon ECR</td>
                <td>コンテナイメージレジストリ</td>
                <td>Pull Through Cache、イメージスキャン</td>
            </tr>
            <tr>
                <td>AWS Lambda</td>
                <td>サーバーレス関数</td>
                <td>Syntheticsカナリー実行</td>
            </tr>
        </tbody>
    </table>
    
    <h3>ネットワーク・コンテンツ配信</h3>
    <table>
        <thead>
            <tr>
                <th>サービス名</th>
                <th>用途</th>
                <th>主な利用機能</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Amazon VPC</td>
                <td>仮想ネットワーク</td>
                <td>サブネット、ルートテーブル、NACL</td>
            </tr>
            <tr>
                <td>Elastic Load Balancing (ALB)</td>
                <td>ロードバランサー</td>
                <td>Application Load Balancer、ターゲットグループ</td>
            </tr>
            <tr>
                <td>Amazon CloudFront</td>
                <td>CDN</td>
                <td>ディストリビューション、キャッシュ動作、エラーページ</td>
            </tr>
            <tr>
                <td>AWS WAF v2</td>
                <td>Webアプリケーションファイアウォール</td>
                <td>マネージドルール、WebACL</td>
            </tr>
            <tr>
                <td>Amazon Route 53</td>
                <td>DNS管理</td>
                <td>ホストゾーン、Aレコード（オプション）</td>
            </tr>
            <tr>
                <td>NAT Gateway</td>
                <td>アウトバウンド通信</td>
                <td>プライベートサブネットからのインターネット接続</td>
            </tr>
            <tr>
                <td>VPC Endpoints</td>
                <td>AWSサービスへのプライベート接続</td>
                <td>S3、ECR、CloudWatch Logs、SSM等</td>
            </tr>
        </tbody>
    </table>
    
    <h3>データストア</h3>
    <table>
        <thead>
            <tr>
                <th>サービス名</th>
                <th>用途</th>
                <th>主な利用機能</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Amazon Aurora</td>
                <td>リレーショナルデータベース</td>
                <td>PostgreSQL互換、自動フェイルオーバー</td>
            </tr>
            <tr>
                <td>Amazon RDS</td>
                <td>データベース管理</td>
                <td>Performance Insights、自動バックアップ</td>
            </tr>
            <tr>
                <td>Amazon S3</td>
                <td>オブジェクトストレージ</td>
                <td>静的コンテンツ、ログ保管、アーティファクト</td>
            </tr>
        </tbody>
    </table>
    
    <h3>セキュリティ・アイデンティティ</h3>
    <table>
        <thead>
            <tr>
                <th>サービス名</th>
                <th>用途</th>
                <th>主な利用機能</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>AWS IAM</td>
                <td>アクセス管理</td>
                <td>ロール、ポリシー、サービスプリンシパル</td>
            </tr>
            <tr>
                <td>AWS KMS</td>
                <td>暗号化キー管理</td>
                <td>CMK、自動キーローテーション</td>
            </tr>
            <tr>
                <td>AWS Certificate Manager</td>
                <td>SSL/TLS証明書</td>
                <td>証明書の発行と管理（オプション）</td>
            </tr>
            <tr>
                <td>AWS Secrets Manager</td>
                <td>シークレット管理</td>
                <td>データベース認証情報（実装予定）</td>
            </tr>
        </tbody>
    </table>
    
    <h3>監視・ロギング</h3>
    <table>
        <thead>
            <tr>
                <th>サービス名</th>
                <th>用途</th>
                <th>主な利用機能</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Amazon CloudWatch</td>
                <td>監視・メトリクス</td>
                <td>メトリクス、アラーム、ダッシュボード</td>
            </tr>
            <tr>
                <td>CloudWatch Logs</td>
                <td>ログ管理</td>
                <td>ロググループ、ログストリーム、保持期間設定</td>
            </tr>
            <tr>
                <td>CloudWatch Container Insights</td>
                <td>コンテナ監視</td>
                <td>ECSメトリクス、パフォーマンス分析</td>
            </tr>
            <tr>
                <td>CloudWatch Synthetics</td>
                <td>外形監視</td>
                <td>カナリー、可用性チェック</td>
            </tr>
            <tr>
                <td>CloudWatch Events (EventBridge)</td>
                <td>イベント駆動</td>
                <td>ECSイベント、RDSイベント</td>
            </tr>
        </tbody>
    </table>
    
    <h3>通知・コミュニケーション</h3>
    <table>
        <thead>
            <tr>
                <th>サービス名</th>
                <th>用途</th>
                <th>主な利用機能</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>Amazon SNS</td>
                <td>通知サービス</td>
                <td>トピック、Email/Slack通知</td>
            </tr>
            <tr>
                <td>AWS Chatbot</td>
                <td>チャット統合</td>
                <td>Slack連携、アラート通知</td>
            </tr>
        </tbody>
    </table>
    
    <h3>CI/CD・開発ツール</h3>
    <table>
        <thead>
            <tr>
                <th>サービス名</th>
                <th>用途</th>
                <th>主な利用機能</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>AWS CodePipeline</td>
                <td>CI/CDパイプライン</td>
                <td>パイプライン定義、ステージ管理</td>
            </tr>
            <tr>
                <td>AWS CodeBuild</td>
                <td>ビルドサービス</td>
                <td>ビルドプロジェクト、CDKシンセサイズ</td>
            </tr>
            <tr>
                <td>AWS CodeStar Connections</td>
                <td>ソース管理連携</td>
                <td>GitHub統合</td>
            </tr>
            <tr>
                <td>AWS CDK</td>
                <td>Infrastructure as Code</td>
                <td>TypeScript、スタック、コンストラクト</td>
            </tr>
        </tbody>
    </table>
    
    <h3>管理・ガバナンス</h3>
    <table>
        <thead>
            <tr>
                <th>サービス名</th>
                <th>用途</th>
                <th>主な利用機能</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>AWS Systems Manager</td>
                <td>システム管理</td>
                <td>Session Manager、Parameter Store</td>
            </tr>
            <tr>
                <td>AWS CloudFormation</td>
                <td>IaCデプロイメント</td>
                <td>CDKが生成するテンプレート</td>
            </tr>
            <tr>
                <td>VPC Flow Logs</td>
                <td>ネットワークトラフィック監視</td>
                <td>トラフィックログ、S3保管</td>
            </tr>
        </tbody>
    </table>
    
    <h3>サービス統計</h3>
    <ul>
        <li><strong>総サービス数</strong>: 35サービス</li>
        <li><strong>主要カテゴリ</strong>: 8カテゴリ</li>
        <li><strong>セキュリティ関連</strong>: 6サービス</li>
        <li><strong>監視関連</strong>: 5サービス</li>
    </ul>
    
    <hr>
    
    <h2>改訂履歴</h2>
    <table>
        <thead>
            <tr>
                <th>バージョン</th>
                <th>日付</th>
                <th>変更内容</th>
                <th>作成者</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>1.0</td>
                <td>2025-08-21</td>
                <td>初版作成</td>
                <td>錦戸</td>
            </tr>
            <tr>
                <td>1.1</td>
                <td>2025-08-25</td>
                <td>利用AWSサービス一覧を追加</td>
                <td>錦戸</td>
            </tr>
        </tbody>
    </table>
    
</body>
</html>